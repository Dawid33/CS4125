<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Register</title>
</head>
<body>
    <div class="container d-flex flex-column justify-content-start align-items-center" style="min-height: 100vh;">
        <div class="row">
            <div class="col text-center mb-5 mt-5">
                <h1><u>Library Management System</u></h1>
            </div>
        </div>
        <div class="row">
            <div class="col text-center mb-3">
                <h3>Please Register</h3>
            </div>
        </div>
        <div class="row">
            <div class="col mb-5">
                <div class="bg-secondary rounded p-3">
                    <form id="registration-form" method="post" action="http://127.0.0.1:8080/api/register">
                        <div class="form-group">
                            <label class="text-white">Username: </label>
                            <input class="form-control" type="text" name="display_name" value="" placeholder="Username" />  
                        </div>
                        <div class="form-group">
                            <label class="text-white">Email: </label>
                            <input class="form-control" type="text" name="email" value="" autocomplete="email" placeholder="test@example.com" />   
                        </div>
                        <div class="form-group mb-2">
                            <label class="text-white">Password: </label>
                            <input class="form-control" type="password" name="password" value="test" autocomplete="password" />    
                        </div>
                        <button class="btn btn-primary" type="submit">Register</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col text-center">
                <a href="{{ url_for('index') }}">Already have an account? Login</a>
            </div>
        </div>
    </div>

    <script>
        let output = document.getElementById("output")
        function api(url) {
          let users = fetch(url).then((res) => {
            res.text().then((text) => {
              output.innerText = text
            })
          })
        }
    
        async function get_post() {
          let posts = fetch('http://127.0.0.1:8080/api/posts');
          post_id = (await (await posts).json())[0].post_id;
          let post = (await (await fetch('http://127.0.0.1:8080/api/post?id=' + post_id)).text());
          output.innerText = post
        }
    
        let registration_form = document.getElementById("registration-form");
    
        registration_form.addEventListener("submit", (e) => {
          e.preventDefault();
          var xhr = new XMLHttpRequest();
          xhr.open("POST", "/api/register");
          let registration_form = document.getElementById("registration-form");
          var formData = new FormData(registration_form);
          xhr.onload = function (event) {
            output.innerText = event.target.response
          };
          xhr.send(formData);
        })
      </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script></body>
</html>